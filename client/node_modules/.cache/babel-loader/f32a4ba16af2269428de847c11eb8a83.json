{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nimport { Keys, classNames, dispatchEvent } from '@progress/kendo-react-common';\nimport * as PropTypes from 'prop-types';\nimport * as React from 'react';\nimport { convertMsgsToViewItems } from './../ViewItem';\nimport ActionGroup from './ActionGroup';\nimport AttachmentGroup from './AttachmentGroup';\nimport DateMarker from './DateMarker';\nimport MessageGroup from './MessageGroup';\nimport NewMessage from './NewMessage';\nimport { ChatMessage } from './ChatMessage';\nimport { validatePackage } from '@progress/kendo-react-common';\nimport { packageMetadata } from '../package-metadata';\nimport { ariaLabelMessageList, messages } from '../messages';\nimport { provideLocalizationService } from '@progress/kendo-react-intl';\n/**\n * Represents the [KendoReact Chat component]({% slug overview_convui %}).\n */\n\nvar Chat =\n/** @class */\nfunction (_super) {\n  __extends(Chat, _super);\n\n  function Chat(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.viewItems = [];\n    _this.isDirectionRightToLeft = false;\n    _this.scrollToBottomOnLoadingData = true;\n\n    _this.onFocus = function () {\n      clearTimeout(_this.timeoutIdForChatLosingFocus);\n    };\n\n    _this.onBlur = function () {\n      // This is a hacky solution to clear the selection when the focus is lost\n      // in favor of an element outside the Chat.\n      // https://medium.com/@jessebeach/dealing-with-focus-and-blur-in-a-composite-widget-in-react-90d3c3b49a9b\n      _this.timeoutIdForChatLosingFocus = window.setTimeout(function () {\n        _this.setState({\n          selectedItemIndex: null\n        });\n      }, 0);\n    };\n\n    _this.onSelectionRequested = function (clickedItemIndex) {\n      _this.setState({\n        selectedItemIndex: clickedItemIndex\n      });\n    };\n\n    _this.onKeyDown = function (event) {\n      var newSelectedItemIndex = null;\n      var currentSelectedItemIndex = _this.state.selectedItemIndex !== null ? _this.state.selectedItemIndex : _this.viewItems.lastSelectionIndex;\n\n      if (event.keyCode === Keys.up) {\n        if (currentSelectedItemIndex === null) {\n          newSelectedItemIndex = 0;\n        } else if (currentSelectedItemIndex > 0) {\n          newSelectedItemIndex = currentSelectedItemIndex - 1;\n        }\n      } else if (event.keyCode === Keys.down) {\n        if (currentSelectedItemIndex === null) {\n          newSelectedItemIndex = 0;\n        } else if (currentSelectedItemIndex < _this.viewItems.lastSelectionIndex) {\n          newSelectedItemIndex = currentSelectedItemIndex + 1;\n        }\n      }\n\n      if (newSelectedItemIndex !== null) {\n        _this.setState({\n          selectedItemIndex: newSelectedItemIndex\n        }); // Prevent the default behavior of moving of the scrollbar\n        // because scrolling is achieved through item focusing.\n\n\n        event.preventDefault();\n      }\n    };\n\n    _this.onMessageSend = function (message, event) {\n      dispatchEvent(_this.props.onMessageSend, event, _this, {\n        message: message\n      });\n    };\n\n    _this.onActionExecute = function (action, event) {\n      dispatchEvent(_this.props.onActionExecute, event, _this, {\n        action: action\n      });\n\n      if (!event.isDefaultPrevented()) {\n        switch (action.type) {\n          case 'reply':\n            _this.onMessageSend({\n              author: _this.props.user,\n              text: action.value,\n              timestamp: new Date()\n            }, event);\n\n            break;\n\n          case 'call':\n            window.open('tel:' + action.value);\n            break;\n\n          case 'openUrl':\n            window.open(action.value);\n            break;\n\n          default:\n            break;\n        }\n\n        _this.newMsgComp.focusInput();\n      }\n    };\n\n    validatePackage(packageMetadata);\n    _this.state = {\n      selectedItemIndex: null,\n      isFirstRender: true\n    };\n    return _this;\n  }\n  /**\n   * @hidden\n   */\n\n\n  Chat.prototype.render = function () {\n    var _this = this;\n\n    this.viewItems = this.getViewItemsFromMsgs(this.props.messages);\n    this.isDirectionRightToLeft = this.checkIsDirectionRightToLeft(this.props);\n    var localizationService = provideLocalizationService(this);\n    return React.createElement(\"div\", {\n      style: {\n        width: this.props.width\n      },\n      onKeyDown: this.onKeyDown,\n      className: this.getClassNames(),\n      ref: function (el) {\n        return _this.chatWrapperEl = el;\n      }\n    }, React.createElement(\"div\", {\n      className: \"k-message-list k-avatars\",\n      onBlur: this.onBlur,\n      onFocus: this.onFocus,\n      role: \"log\",\n      \"aria-label\": localizationService.toLanguageString(ariaLabelMessageList, messages[ariaLabelMessageList]),\n      \"aria-live\": \"polite\",\n      onScroll: function (e) {\n        _this.scrollToBottomOnLoadingData = e.currentTarget.scrollTop === e.currentTarget.scrollHeight - e.currentTarget.clientHeight;\n      },\n      ref: function (el) {\n        return _this.viewItemsWrapperEl = el;\n      }\n    }, React.createElement(\"div\", {\n      className: \"k-message-list-content\"\n    }, this.renderViewItems())), React.createElement(NewMessage, {\n      user: this.props.user,\n      onMessageSend: this.onMessageSend,\n      isDirectionRightToLeft: this.isDirectionRightToLeft,\n      ref: function (comp) {\n        return _this.newMsgComp = comp;\n      },\n      placeholder: this.props.placeholder,\n      MessageBox: this.props.messageBox,\n      toolbar: this.props.toolbar,\n      onToolbarActionButtonClick: this.props.onToolbarActionExecute,\n      showToolbar: this.props.showToolbar\n    }));\n  };\n  /**\n   * @hidden\n   */\n\n\n  Chat.prototype.componentDidMount = function () {\n    var _this = this;\n\n    this.setState({\n      isFirstRender: false\n    }, function () {\n      // W/o window.setTimeout the scrolling does not manage to go to the bottom, some offset is left.\n      _this.nextTickId = window.setTimeout(function () {\n        return _this.scrollViewItemsToBottom();\n      }, 250);\n    });\n  };\n  /**\n   * @hidden\n   */\n\n\n  Chat.prototype.componentWillUnmount = function () {\n    clearTimeout(this.nextTickId);\n  };\n  /**\n   * @hidden\n   */\n\n\n  Chat.prototype.componentDidUpdate = function (prevProps) {\n    if (prevProps.messages.length !== this.props.messages.length && this.scrollToBottomOnLoadingData) {\n      this.scrollViewItemsToBottom();\n    }\n  };\n\n  Chat.prototype.getClassNames = function () {\n    return classNames('k-chat', this.props.className, {\n      'k-rtl': this.isDirectionRightToLeft\n    });\n  };\n\n  Chat.prototype.checkIsDirectionRightToLeft = function (props) {\n    var result = props.dir !== undefined ? props.dir === 'rtl' : this.chatWrapperEl && getComputedStyle(this.chatWrapperEl).direction === 'rtl';\n    return Boolean(result);\n  };\n\n  Chat.prototype.renderViewItems = function () {\n    var _this = this;\n\n    var lastViewItemIndex = this.viewItems.length - 1;\n    return this.viewItems.map(function (viewItem, index) {\n      if (viewItem.type === 'date-marker') {\n        return React.createElement(DateMarker, {\n          item: viewItem,\n          key: index\n        });\n      } else if (viewItem.type === 'message-group') {\n        return React.createElement(MessageGroup, {\n          group: viewItem,\n          itemTemplate: _this.props.messageTemplate,\n          attachmentTemplate: _this.props.attachmentTemplate,\n          user: _this.props.user,\n          selectedItemIndex: _this.state.selectedItemIndex,\n          onRequestSelection: _this.onSelectionRequested,\n          isLastGroup: index === lastViewItemIndex,\n          key: index,\n          message: _this.props.message || Chat.defaultProps.message\n        });\n      } else if (viewItem.type === 'attachment-group') {\n        return React.createElement(AttachmentGroup, {\n          group: viewItem,\n          itemTemplate: _this.props.attachmentTemplate,\n          onRequestSelection: _this.onSelectionRequested,\n          selected: viewItem.selectionIndex === _this.state.selectedItemIndex,\n          isLastGroup: index === lastViewItemIndex,\n          key: index\n        });\n      } else if (viewItem.type === 'action-group') {\n        return React.createElement(ActionGroup, {\n          group: viewItem,\n          onActionExecute: _this.onActionExecute,\n          onRequestSelection: _this.onSelectionRequested,\n          selected: viewItem.selectionIndex === _this.state.selectedItemIndex,\n          isLastGroup: index === lastViewItemIndex,\n          key: index\n        });\n      }\n    });\n  };\n\n  Chat.prototype.scrollViewItemsToBottom = function () {\n    if (this.viewItemsWrapperEl) {\n      this.viewItemsWrapperEl.scrollTop = this.viewItemsWrapperEl.scrollHeight - this.viewItemsWrapperEl.clientHeight;\n    }\n  };\n\n  Chat.prototype.getViewItemsFromMsgs = function (msgs) {\n    return msgs.length > 0 ? convertMsgsToViewItems(msgs) : [];\n  };\n  /**\n   * @hidden\n   */\n\n\n  Chat.propTypes = {\n    messages: PropTypes.arrayOf(PropTypes.object),\n    user: PropTypes.object,\n    messageTemplate: PropTypes.any,\n    attachmentTemplate: PropTypes.any,\n    width: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n    onMessageSend: PropTypes.func,\n    onActionExecute: PropTypes.func,\n    dir: PropTypes.string,\n    messageBox: PropTypes.any\n  };\n  /**\n   * @hidden\n   */\n\n  Chat.defaultProps = {\n    messages: [],\n    dateFormat: 'g',\n    message: ChatMessage\n  };\n  return Chat;\n}(React.Component);\n\nexport { Chat };","map":{"version":3,"sources":["C:/Users/vishn/Desktop/AuthInMern/client/node_modules/@progress/kendo-react-conversational-ui/dist/es/components/Chat.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","constructor","create","Keys","classNames","dispatchEvent","PropTypes","React","convertMsgsToViewItems","ActionGroup","AttachmentGroup","DateMarker","MessageGroup","NewMessage","ChatMessage","validatePackage","packageMetadata","ariaLabelMessageList","messages","provideLocalizationService","Chat","_super","props","_this","viewItems","isDirectionRightToLeft","scrollToBottomOnLoadingData","onFocus","clearTimeout","timeoutIdForChatLosingFocus","onBlur","window","setTimeout","setState","selectedItemIndex","onSelectionRequested","clickedItemIndex","onKeyDown","event","newSelectedItemIndex","currentSelectedItemIndex","state","lastSelectionIndex","keyCode","up","down","preventDefault","onMessageSend","message","onActionExecute","action","isDefaultPrevented","type","author","user","text","value","timestamp","Date","open","newMsgComp","focusInput","isFirstRender","render","getViewItemsFromMsgs","checkIsDirectionRightToLeft","localizationService","createElement","style","width","className","getClassNames","ref","el","chatWrapperEl","role","toLanguageString","onScroll","e","currentTarget","scrollTop","scrollHeight","clientHeight","viewItemsWrapperEl","renderViewItems","comp","placeholder","MessageBox","messageBox","toolbar","onToolbarActionButtonClick","onToolbarActionExecute","showToolbar","componentDidMount","nextTickId","scrollViewItemsToBottom","componentWillUnmount","componentDidUpdate","prevProps","length","result","dir","undefined","getComputedStyle","direction","Boolean","lastViewItemIndex","map","viewItem","index","item","key","group","itemTemplate","messageTemplate","attachmentTemplate","onRequestSelection","isLastGroup","defaultProps","selected","selectionIndex","msgs","propTypes","arrayOf","object","any","oneOfType","string","number","func","dateFormat","Component"],"mappings":"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","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { Keys, classNames, dispatchEvent } from '@progress/kendo-react-common';\nimport * as PropTypes from 'prop-types';\nimport * as React from 'react';\nimport { convertMsgsToViewItems } from './../ViewItem';\nimport ActionGroup from './ActionGroup';\nimport AttachmentGroup from './AttachmentGroup';\nimport DateMarker from './DateMarker';\nimport MessageGroup from './MessageGroup';\nimport NewMessage from './NewMessage';\nimport { ChatMessage } from './ChatMessage';\nimport { validatePackage } from '@progress/kendo-react-common';\nimport { packageMetadata } from '../package-metadata';\nimport { ariaLabelMessageList, messages } from '../messages';\nimport { provideLocalizationService } from '@progress/kendo-react-intl';\n/**\n * Represents the [KendoReact Chat component]({% slug overview_convui %}).\n */\nvar Chat = /** @class */ (function (_super) {\n    __extends(Chat, _super);\n    function Chat(props) {\n        var _this = _super.call(this, props) || this;\n        _this.viewItems = [];\n        _this.isDirectionRightToLeft = false;\n        _this.scrollToBottomOnLoadingData = true;\n        _this.onFocus = function () {\n            clearTimeout(_this.timeoutIdForChatLosingFocus);\n        };\n        _this.onBlur = function () {\n            // This is a hacky solution to clear the selection when the focus is lost\n            // in favor of an element outside the Chat.\n            // https://medium.com/@jessebeach/dealing-with-focus-and-blur-in-a-composite-widget-in-react-90d3c3b49a9b\n            _this.timeoutIdForChatLosingFocus = window.setTimeout(function () { _this.setState({ selectedItemIndex: null }); }, 0);\n        };\n        _this.onSelectionRequested = function (clickedItemIndex) {\n            _this.setState({ selectedItemIndex: clickedItemIndex });\n        };\n        _this.onKeyDown = function (event) {\n            var newSelectedItemIndex = null;\n            var currentSelectedItemIndex = _this.state.selectedItemIndex !== null ?\n                _this.state.selectedItemIndex :\n                _this.viewItems.lastSelectionIndex;\n            if (event.keyCode === Keys.up) {\n                if (currentSelectedItemIndex === null) {\n                    newSelectedItemIndex = 0;\n                }\n                else if (currentSelectedItemIndex > 0) {\n                    newSelectedItemIndex = currentSelectedItemIndex - 1;\n                }\n            }\n            else if (event.keyCode === Keys.down) {\n                if (currentSelectedItemIndex === null) {\n                    newSelectedItemIndex = 0;\n                }\n                else if (currentSelectedItemIndex < _this.viewItems.lastSelectionIndex) {\n                    newSelectedItemIndex = currentSelectedItemIndex + 1;\n                }\n            }\n            if (newSelectedItemIndex !== null) {\n                _this.setState({ selectedItemIndex: newSelectedItemIndex });\n                // Prevent the default behavior of moving of the scrollbar\n                // because scrolling is achieved through item focusing.\n                event.preventDefault();\n            }\n        };\n        _this.onMessageSend = function (message, event) {\n            dispatchEvent(_this.props.onMessageSend, event, _this, { message: message });\n        };\n        _this.onActionExecute = function (action, event) {\n            dispatchEvent(_this.props.onActionExecute, event, _this, { action: action });\n            if (!event.isDefaultPrevented()) {\n                switch (action.type) {\n                    case 'reply':\n                        _this.onMessageSend({\n                            author: _this.props.user,\n                            text: action.value,\n                            timestamp: new Date()\n                        }, event);\n                        break;\n                    case 'call':\n                        window.open('tel:' + action.value);\n                        break;\n                    case 'openUrl':\n                        window.open(action.value);\n                        break;\n                    default:\n                        break;\n                }\n                _this.newMsgComp.focusInput();\n            }\n        };\n        validatePackage(packageMetadata);\n        _this.state = { selectedItemIndex: null, isFirstRender: true };\n        return _this;\n    }\n    /**\n     * @hidden\n     */\n    Chat.prototype.render = function () {\n        var _this = this;\n        this.viewItems = this.getViewItemsFromMsgs(this.props.messages);\n        this.isDirectionRightToLeft = this.checkIsDirectionRightToLeft(this.props);\n        var localizationService = provideLocalizationService(this);\n        return (React.createElement(\"div\", { style: { width: this.props.width }, onKeyDown: this.onKeyDown, className: this.getClassNames(), ref: function (el) { return _this.chatWrapperEl = el; } },\n            React.createElement(\"div\", { className: \"k-message-list k-avatars\", onBlur: this.onBlur, onFocus: this.onFocus, role: \"log\", \"aria-label\": localizationService.toLanguageString(ariaLabelMessageList, messages[ariaLabelMessageList]), \"aria-live\": \"polite\", onScroll: function (e) {\n                    _this.scrollToBottomOnLoadingData =\n                        (e.currentTarget.scrollTop === e.currentTarget.scrollHeight - e.currentTarget.clientHeight);\n                }, ref: function (el) { return _this.viewItemsWrapperEl = el; } },\n                React.createElement(\"div\", { className: \"k-message-list-content\" }, this.renderViewItems())),\n            React.createElement(NewMessage, { user: this.props.user, onMessageSend: this.onMessageSend, isDirectionRightToLeft: this.isDirectionRightToLeft, ref: function (comp) { return _this.newMsgComp = comp; }, placeholder: this.props.placeholder, MessageBox: this.props.messageBox, toolbar: this.props.toolbar, onToolbarActionButtonClick: this.props.onToolbarActionExecute, showToolbar: this.props.showToolbar })));\n    };\n    /**\n     * @hidden\n     */\n    Chat.prototype.componentDidMount = function () {\n        var _this = this;\n        this.setState({ isFirstRender: false }, function () {\n            // W/o window.setTimeout the scrolling does not manage to go to the bottom, some offset is left.\n            _this.nextTickId = window.setTimeout(function () { return _this.scrollViewItemsToBottom(); }, 250);\n        });\n    };\n    /**\n     * @hidden\n     */\n    Chat.prototype.componentWillUnmount = function () {\n        clearTimeout(this.nextTickId);\n    };\n    /**\n     * @hidden\n     */\n    Chat.prototype.componentDidUpdate = function (prevProps) {\n        if (prevProps.messages.length !== this.props.messages.length && this.scrollToBottomOnLoadingData) {\n            this.scrollViewItemsToBottom();\n        }\n    };\n    Chat.prototype.getClassNames = function () {\n        return classNames('k-chat', this.props.className, { 'k-rtl': this.isDirectionRightToLeft });\n    };\n    Chat.prototype.checkIsDirectionRightToLeft = function (props) {\n        var result = props.dir !== undefined ? props.dir === 'rtl' :\n            this.chatWrapperEl && getComputedStyle(this.chatWrapperEl).direction === 'rtl';\n        return Boolean(result);\n    };\n    Chat.prototype.renderViewItems = function () {\n        var _this = this;\n        var lastViewItemIndex = this.viewItems.length - 1;\n        return this.viewItems\n            .map(function (viewItem, index) {\n            if (viewItem.type === 'date-marker') {\n                return React.createElement(DateMarker, { item: viewItem, key: index });\n            }\n            else if (viewItem.type === 'message-group') {\n                return (React.createElement(MessageGroup, { group: viewItem, itemTemplate: _this.props.messageTemplate, attachmentTemplate: _this.props.attachmentTemplate, user: _this.props.user, selectedItemIndex: _this.state.selectedItemIndex, onRequestSelection: _this.onSelectionRequested, isLastGroup: index === lastViewItemIndex, key: index, message: _this.props.message || Chat.defaultProps.message }));\n            }\n            else if (viewItem.type === 'attachment-group') {\n                return (React.createElement(AttachmentGroup, { group: viewItem, itemTemplate: _this.props.attachmentTemplate, onRequestSelection: _this.onSelectionRequested, selected: viewItem.selectionIndex === _this.state.selectedItemIndex, isLastGroup: index === lastViewItemIndex, key: index }));\n            }\n            else if (viewItem.type === 'action-group') {\n                return (React.createElement(ActionGroup, { group: viewItem, onActionExecute: _this.onActionExecute, onRequestSelection: _this.onSelectionRequested, selected: viewItem.selectionIndex === _this.state.selectedItemIndex, isLastGroup: index === lastViewItemIndex, key: index }));\n            }\n        });\n    };\n    Chat.prototype.scrollViewItemsToBottom = function () {\n        if (this.viewItemsWrapperEl) {\n            this.viewItemsWrapperEl.scrollTop =\n                this.viewItemsWrapperEl.scrollHeight - this.viewItemsWrapperEl.clientHeight;\n        }\n    };\n    Chat.prototype.getViewItemsFromMsgs = function (msgs) {\n        return msgs.length > 0 ? convertMsgsToViewItems(msgs) : [];\n    };\n    /**\n     * @hidden\n     */\n    Chat.propTypes = {\n        messages: PropTypes.arrayOf(PropTypes.object),\n        user: PropTypes.object,\n        messageTemplate: PropTypes.any,\n        attachmentTemplate: PropTypes.any,\n        width: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n        onMessageSend: PropTypes.func,\n        onActionExecute: PropTypes.func,\n        dir: PropTypes.string,\n        messageBox: PropTypes.any\n    };\n    /**\n     * @hidden\n     */\n    Chat.defaultProps = {\n        messages: [],\n        dateFormat: 'g',\n        message: ChatMessage\n    };\n    return Chat;\n}(React.Component));\nexport { Chat };\n"]},"metadata":{},"sourceType":"module"}